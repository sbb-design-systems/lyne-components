@use '@sbb-esta/lyne-elements/core/styles' as sbb;
@use '@sbb-esta/lyne-elements/core/styles/mixins/popover';

// Box-sizing rules contained in typography are not traversing Shadow DOM boundaries. We need to include box-sizing mixin in every component.
@include sbb.box-sizing;

:host {
  // Note: The use of px is intentional here, because many widths/heights, rotations, scales, etc. depends on this.
  --sbb-seat-reservation-grid-size: 16px;
  --sbb-seat-reservation-vertical-screen-height: 0;

  display: block;

  ::part(coach-floor) {
    fill: var(--sbb-color-white);

    // In High Contrast Mode we set floor color to transparent
    @include sbb.if-forced-colors {
      fill: transparent;
    }
  }
}

[popover]:where(sbb-popover) {
  @include popover.popover-reset;
}

// MAIN SEAT RESERVATRION GRID LAYOUT
// __________________ ________________ ____________________
// |__LEFT_NAV_BUTTON_|___NAV_COACHES__|_RIGHT_NAV_BUTTON___|
// |________________________COACHES_________________________|
.sbb-sr__grid {
  display: grid;
  grid-template-columns: 20% 1fr 20%;
  grid-template-rows: auto calc(var(--sbb-seat-reservation-grid-size) * 16);
  grid-gap: 0;

  .sbb-sr-navigation-first-grid {
    grid-column: 1 / 2;
    grid-row-start: 1;
    position: relative;
  }

  .sbb-sr-navigation-last-grid {
    grid-column: 3 / 4;
    grid-row-start: 1;
    position: relative;
  }

  .sbb-sr__component {
    grid-column: 1 / 4;
    grid-row: 1 / 3;
  }

  .sbb-sr-grid-inner {
    display: grid;
    grid-template-columns: 20% 60% 20%;
    grid-template-rows: auto 1fr;
    grid-gap: 0;

    .nav-grid {
      grid-column: 2 / 3;
      grid-row: 1 / 2;
      display: inherit;
    }

    .coaches-grid {
      grid-column: 1 / 4;
      grid-row: 2 / 3;
      display: inherit;

      .sbb-sr__wrapper {
        overflow: hidden;
      }
    }
  }
}

// ------------- Seat Reservation Main Navigation - START -----------------
.sbb-sr__navigation-control-button {
  position: absolute;
  z-index: 10;

  &::before {
    content: '';
    display: block;
    width: sbb.px-to-rem-build(42);
    height: sbb.px-to-rem-build(80);
    position: absolute;
    top: 0;
    z-index: 0;
    pointer-events: none;
  }

  &#first-tab-element {
    right: sbb.px-to-rem-build(-42);

    &::before {
      right: 0;
      background: linear-gradient(-90deg, rgb(255 255 255 / 0%) 0%, rgb(255 255 255 / 100%) 50%);
    }
  }

  &#last-tab-element {
    left: sbb.px-to-rem-build(-42);

    &::before {
      background: linear-gradient(90deg, rgb(255 255 255 / 0%) 0%, rgb(255 255 255 / 100%) 50%);
    }
  }
}

.sbb-sr-navigation-wrapper {
  overflow: hidden;
}

.sbb-sr-navigation {
  @include sbb.scrollbar;

  & {
    // Set sbb scrollbar transparent by default
    --sbb-scrollbar-color: rgb(0 0 0 / 0%);

    display: flex;
    overflow: scroll hidden;
    position: relative;
  }
}

.sbb-sr-navigation__list-coaches {
  @include sbb.list-reset;

  display: flex;
  flex-wrap: nowrap;
  gap: var(--sbb-spacing-fixed-1x);
  padding: sbb.px-to-rem-build(2) sbb.px-to-rem-build(48);
}

// --------------- Seat Reservation Main Navigation - END ----------------

// ------------- Seat Reservation Coaches - START -----------------
.sbb-sr__parent {
  @include sbb.scrollbar;

  & {
    overflow: scroll;
    min-height: var(--sbb-seat-reservation-vertical-screen-height);
    padding: sbb.px-to-rem-build(48) 0;
  }
}

.sbb-sr__list-coaches {
  @include sbb.list-reset;

  display: flex;
  gap: sbb.px-to-rem-build(4);
}

.sbb-sr__item-coach {
  padding: 0;
  margin: 0;
  position: relative;
}

.sbb-sr-popover {
  margin: 0;
}

.sbb-sr-coach-wrapper__table {
  outline: 0;
}

// ------------- Seat Reservation Coaches END -----------------

// MAIN SEAT RESERVATRION GRID LAYOUT - VERTCIAL MODE
//  ____  _____
// |     |  L  |
// |     |     |
// |     |  N  |
// |     |  A  |
// |     |  V  |
// |  C  |_____|
// |  O  |  C  |
// |  A  |     |
// |  C  |  N  |
// |  H  |  A  |
// |  E  |  V  |
// |  S  |_____|
// |     |  R  |
// |     |     |
// |     |  N  |
// |     |  A  |
// |     |  V  |
// |_____|_____|
.sbb-sr.sbb-sr__grid--vertical {
  grid-template-columns: calc(var(--sbb-seat-reservation-grid-size) * 16) auto;
  grid-template-rows: 10% 50% 10%;

  .sbb-sr-navigation-first-grid {
    grid-column: 2 / 3;
    grid-row-start: 1;

    #first-tab-element {
      position: absolute;
      right: initial;
      bottom: sbb.px-to-rem-build(-42);
      left: sbb.px-to-rem-build(2);
      rotate: 90deg;

      &::before {
        top: sbb.px-to-rem-build(-38);
      }
    }
  }

  .sbb-sr-navigation-last-grid {
    grid-column: 2 / 3;
    grid-row: 3 / 4;

    #last-tab-element {
      top: sbb.px-to-rem-build(-42);
      left: sbb.px-to-rem-build(2);
      rotate: 90deg;

      &::before {
        left: sbb.px-to-rem-build(0);
        top: sbb.px-to-rem-build(-38);
      }
    }
  }

  .sbb-sr__component {
    grid-column: 1 / 3;
    grid-row: 1 / 4;
  }

  .sbb-sr-grid-inner {
    grid-template-columns: calc(var(--sbb-seat-reservation-grid-size) * 16) auto;
    grid-template-rows: 10% 50% 10%;

    .nav-grid {
      grid-column: 2 / 3;
      grid-row: 2 / 3;

      .sbb-sr-navigation {
        display: block;
        overflow: hidden scroll;
        height: 100%;

        .sbb-sr-navigation__list-coaches {
          flex-direction: column;
          padding: sbb.px-to-rem-build(48) sbb.px-to-rem-build(2);
        }
      }
    }

    .coaches-grid {
      grid-column: 1 / 2;
      grid-row: 1 / 4;
      overflow: hidden;
      position: relative;

      .sbb-sr__parent {
        @include sbb.scrollbar;

        & {
          overflow: hidden scroll;
          height: 100%;
          padding: sbb.px-to-rem-build(48) 0;
          position: relative;
          top: 0;
        }

        .sbb-sr__list-coaches {
          rotate: 90deg;
        }
      }
    }
  }
}
