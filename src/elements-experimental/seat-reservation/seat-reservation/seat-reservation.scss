@use '@sbb-esta/lyne-elements/core/styles' as sbb;
@use '../common/styles/seat-reservation-mixins' as sbb-sr-mixins;
@use '../common/styles/seat-reservation-functions' as sbb-sr-functions;

$max-coach-navigation-width: calc(960px - 96px);
$scrollbar-height: 16px;

:host {
  // Note: The use of px is intentional here, because many widths/heights, rotations, scales, etc. depends on this.
  --sbb-seat-reservation-grid-size: 16px;
  --sbb-seat-reservation-height: 0;
  --sbb-seat-reservation-decks: 1;

  display: block;
  height: inherit;

  ::part(coach-floor) {
    fill: var(--sbb-background-color-2);

    // In High Contrast Mode we set floor color to transparent
    @include sbb.if-forced-colors {
      fill: transparent;
    }
  }
}

// START - Vertical mode
:host([align-vertical]) {
  $coach-scollbar-width: 24;
  $coach-grid-width: calc(var(--sbb-seat-reservation-height) + $coach-scollbar-width);

  .sbb-sr__component {
    flex-direction: row-reverse;
    justify-content: flex-end;
    gap: 32px;
    height: inherit;

    @include sbb.mq($from: small) {
      gap: 64px;
    }

    nav.sbb-sr-navigation,
    ul.sbb-sr-navigation__list-coaches {
      flex-direction: column;
    }

    nav.sbb-sr-navigation {
      padding-inline: 0;
      padding-block: 16px;

      .sbb-sr__navigation-control-button {
        left: 1px;
        rotate: 90deg;
      }

      ul.sbb-sr-navigation__list-coaches {
        max-width: initial;

        // Padding needs to visual focus-visible style for nav button inside overflow content,
        // otherwise focus-visible style is cutted.
        padding-block: 6px;
        padding-inline: 5px 0;

        & {
          overflow: hidden scroll;
        }
      }
    }
  }

  // VERTICAL MODE - LABELMULTIPLE DECKS - LABELS
  .sbb-sr__wrapper-coach-decks {
    flex-direction: column;

    .sbb-sr__wrapper-deck-labels {
      flex-direction: column-reverse;
      width: sbb-sr-functions.sr-px-to-rem($coach-grid-width);
      height: initial;

      b {
        width: calc(50% - sbb-sr-functions.sr-px-to-rem(16));
        height: sbb-sr-functions.sr-px-to-rem(20);
        margin-bottom: 16px;
        rotate: initial;
        writing-mode: initial;
      }
    }
  }

  // VERTICAL MODE - SEATMAP SCROLL AREA
  .sbb-sr__wrapper-scrollarea {
    width: sbb-sr-functions.sr-px-to-rem($coach-grid-width);
    height: 100%;

    & {
      overflow: hidden scroll;

      .sbb-sr__parent {
        flex-direction: row;
        rotate: 90deg;
      }
    }
  }
}

// END - Vertical mode

nav.sbb-sr-navigation {
  padding-inline: 0;
  gap: 4px;
}

nav.sbb-sr-navigation .sbb-sr__navigation-control-button {
  position: relative;
  top: 2px;

  @include sbb.mq($from: large) {
    top: 0;
  }
}

.sbb-sr__component {
  display: flex;
  flex-direction: column;
  gap: calc(64px - $scrollbar-height);
}

// NAVIGATION NEW
.sbb-sr-navigation-wrapper {
  display: flex;
  flex-direction: row;
}

nav.sbb-sr-navigation {
  display: flex;
  justify-content: center;
  width: 100%;
  padding-inline: 16px;
}

ul.sbb-sr-navigation__list-coaches {
  @include sbb.list-reset;
  @include sbb.scrollbar;

  display: flex;
  flex-wrap: nowrap;
  gap: sbb-sr-functions.sr-px-to-rem(4);
  padding: 6px 6px 0;
  max-width: $max-coach-navigation-width; // calc(960px - 96px);

  & {
    // Set sbb scrollbar transparent by default
    --sbb-scrollbar-color: transparent;

    display: flex;
    overflow: scroll hidden;
    position: relative;
  }
}

// --------------- Seat Reservation Main Navigation - END ----------------

// ------------- Seat Reservation Coaches - START -----------------
.sbb-sr__wrapper-coach-decks {
  display: flex;
  overflow: hidden;
  height: inherit;

  .sbb-sr__wrapper-deck-labels {
    display: flex;
    justify-content: space-between;
    height: sbb-sr-functions.sr-px-to-rem(var(--sbb-seat-reservation-height));
    writing-mode: vertical-lr;

    b {
      height: calc(50% - sbb-sr-functions.sr-px-to-rem(16));
      width: sbb-sr-functions.sr-px-to-rem(20);
      margin-block-end: 16px;
      rotate: 180deg;
      text-align: center;
      line-height: sbb-sr-functions.sr-px-to-rem(20);
    }
  }
}

.sbb-sr__wrapper-scrollarea {
  @include sbb.scrollbar;

  & {
    overflow: scroll hidden;
    padding-block: sbb-sr-functions.sr-px-to-rem(8) sbb-sr-functions.sr-px-to-rem(16);

    .sbb-sr__parent {
      display: flex;
      flex-direction: column;
      position: relative;
    }
  }
}

.sbb-sr__list-decks {
  @include sbb.list-reset;

  display: flex;
  flex-direction: column;
}

.sbb-sr__list-decks--gap {
  gap: sbb-sr-functions.sr-px-to-rem(48);
}

.sbb-sr__list-item-deck {
  position: relative;
}

.sbb-sr__list-coaches {
  @include sbb.list-reset;

  display: flex;
  flex-direction: row;
  gap: sbb-sr-functions.sr-px-to-rem(4);
}

.sbb-sr__item-coach {
  position: relative;
}

.sbb-sr-popover {
  margin: 0;
}

.sbb-sr-coach-wrapper__table {
  outline: 0;
}

// rotates the DOM-part "coach-floor" by 180 degrees if the host is in RTL mode.
@include sbb-sr-mixins.rotate-dom-part(coach-floor);

[popover]:where(sbb-popover) {
  @include sbb.popover-reset;
}
